<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, viewport-fit=cover" />
  <title>Olivia Sims — School Task Calendar</title>
  <style>
    * { box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    :root{
      --red-1:#ffe5e5; --red-2:#ffd6d6; --red-3:#ffcccc; --red-4:#ff9999; --red-5:#d93a3a;
      --ink:#3c0a0a; --card:#fffafa; --card-2:#fff1f1; --muted:#a34747;
      --ok:#66cc66; --warn:#ff9933; --bad:#ff3333;
    }
    body { font-family: 'Poppins', -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
           background: linear-gradient(135deg, var(--red-1) 0%, var(--red-2) 100%);
           display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; color: var(--ink); }
    .app { width: 96%; max-width: 900px; background: var(--card); border-radius: 20px;
           box-shadow: 0 10px 25px rgba(255, 100, 100, 0.2); overflow: hidden; padding: 16px; animation: fadeIn .6s ease; }
    @keyframes fadeIn { from{opacity:0; transform: translateY(8px);} to{opacity:1; transform:none;} }

    /* Tabs */
    .tabs { display:flex; gap:8px; justify-content:center; margin-bottom:12px; flex-wrap:wrap; }
    .tab-btn { border:none; cursor:pointer; background: var(--red-2); color: var(--ink);
               padding: 10px 14px; border-radius: 999px; font-weight:700; min-height:44px; min-width:44px; }
    .tab-btn[aria-selected="true"]{ background: var(--red-5); color:#fff; box-shadow: 0 6px 16px rgba(217,58,58,.25); }

    header { display:flex; justify-content:space-between; align-items:center; gap:10px; flex-wrap:wrap; margin-bottom:10px; }
    header h1 { color: var(--red-5); font-size: 1.5em; margin:0; text-align:center; flex:1 1 100%; }

    .nav-buttons button { background: var(--red-2); border:none; padding:12px 18px; border-radius:50%;
                          font-size:1.4em; color:var(--red-5); cursor:pointer; min-height:44px; min-width:44px; }

    .quote { font-size:.95em; margin: 4px 0 10px; color: var(--muted); text-align:center; font-style:italic; }

    .weekdays, .days { display:grid; grid-template-columns: repeat(7, 1fr); gap: 8px; }
    .weekdays div { color: var(--red-5); font-weight: 700; text-align:center; }

    .day-cell { padding: 10px; border-radius: 10px; background: var(--card-2); cursor: pointer; min-height:44px; text-align:center; }
    .day-cell:hover { background: var(--red-3); }
    .today { background: var(--red-5); color:#fff; font-weight:700; }

    .toolbar { display:flex; gap:8px; justify-content:center; align-items:center; margin:10px 0; flex-wrap:wrap; }
    .ghost { background: var(--red-2); color: var(--ink); border:1px solid var(--red-3); border-radius:10px; padding:10px 14px; cursor:pointer; font-weight:700; }

    .form { display:flex; flex-wrap:wrap; gap:8px; justify-content:center; margin-top:10px; }
    input, select, button.primary { padding:12px; border-radius:10px; border:1px solid var(--red-3); font-size:1em; min-height:44px; }
    button.primary { background: var(--red-5); color:#fff; border:none; cursor:pointer; font-weight:700; border-radius:10px; }
    button.primary:hover { filter: brightness(1.07); }

    ul.list { list-style:none; padding:0; margin-top:12px; }
    .item { background: var(--card-2); border-radius:10px; padding:10px; margin:6px 0;
            display:flex; justify-content:space-between; align-items:center; gap:10px; }
    .item.done { opacity:.6; text-decoration: line-through; }
    .badge { padding:4px 8px; border-radius:8px; font-size:.8em; margin-right:6px; background: var(--red-2); }
    .dot { width:10px; height:10px; border-radius:50%; display:inline-block; margin-left:6px; }
    .high{ background:var(--bad);} .medium{ background:var(--warn);} .low{ background:var(--ok);}
    .delete-btn { background: var(--red-5); color:#fff; border:none; border-radius:8px; padding:6px 10px; cursor:pointer; font-size:.85em; }
    .delete-btn:hover { background: var(--red-4); }
    .bulk-delete { display:block; width:100%; background: var(--red-5); color:white; border:none; border-radius:10px; padding:12px; margin-top:10px; cursor:pointer; font-weight:700; }
    .bulk-delete:hover { background: var(--red-4); }

    /* Modal */
    .modal-backdrop{ position:fixed; inset:0; background: rgba(0,0,0,.28); display:none; align-items:center; justify-content:center; padding:16px; z-index: 30; }
    .modal{ background:#fff; width:min(680px, 100%); border-radius:16px; padding:16px; box-shadow: 0 10px 30px rgba(0,0,0,.25); }
    .modal header{ display:flex; justify-content:space-between; align-items:center; margin:0 0 10px; }
    .modal h2{ color: var(--red-5); font-size:1.2em; margin:0; }
    .modal textarea{ width:100%; min-height:180px; border:1px solid var(--red-3); border-radius:12px; padding:12px; background: var(--card-2); font-size:.96em; }
    .modal .actions{ display:flex; gap:8px; justify-content:flex-end; margin-top:10px; }

    /* Lock Screen */
    .lock { position: fixed; inset: 0; display: grid; place-items: center;
            background: linear-gradient(145deg, var(--red-1), var(--red-2)); z-index: 40; padding: 20px; }
    .lock-card { background: var(--card); width: min(560px, 100%); border-radius: 20px; padding: 20px;
                 box-shadow: 0 10px 30px rgba(217,58,58,.25); text-align: center; }
    .lock h2 { margin: 0 0 6px; color: var(--red-5); }
    .lock p { margin: 0 0 14px; color: var(--muted); }
    .lock input { width: 100%; padding: 12px; border-radius: 12px; border: 1px solid var(--red-3); font-size: 1em; min-height: 44px; }
    .lock .actions { display: flex; gap: 8px; justify-content: center; margin-top: 12px; }
    .shake { animation: shake .35s ease; }
    @keyframes shake { 10%, 90% {transform: translateX(-1px);} 20%, 80% {transform: translateX(2px);} 30%, 50%, 70% {transform: translateX(-4px);} 40%, 60% {transform: translateX(4px);} }

    @media (max-width: 600px){
      .app{ padding:12px; }
      header h1{ font-size:1.25em; }
      .weekdays div, .day-cell{ font-size:.85em; }
      .form{ flex-direction:column; }
      input, select, button.primary{ width:100%; }
    }
  </style>
</head>
<body>
  <!-- Lock Screen -->
  <div class="lock" id="lockScreen" role="dialog" aria-modal="true" aria-labelledby="lockTitle">
    <div class="lock-card" id="lockCard">
      <h2 id="lockTitle">Olivia Sims — Secure Calendar</h2>
      <p>Enter your password to access your calendar.</p>
      <input id="lockInput" type="password" placeholder="Password" autocomplete="current-password" />
      <div class="actions">
        <button class="primary" id="unlockBtn" aria-label="Unlock">Unlock</button>
      </div>
    </div>
  </div>

  <main class="app" role="application" id="appRoot" hidden>
    <!-- Tabs -->
    <nav class="tabs" role="tablist" aria-label="Views">
      <button class="tab-btn" id="tabCalendar" role="tab" aria-controls="viewCalendar" aria-selected="true">Calendar View</button>
      <button class="tab-btn" id="tabWeekly" role="tab" aria-controls="viewWeekly" aria-selected="false">Weekly View</button>
    </nav>

    <!-- Calendar View -->
    <section id="viewCalendar" role="tabpanel" aria-labelledby="tabCalendar">
      <header>
        <div class="nav-buttons"><button id="prevMonth" aria-label="Previous month">⟨</button></div>
        <h1 id="monthYear">Olivia's School Tasks</h1>
        <div class="nav-buttons"><button id="nextMonth" aria-label="Next month">⟩</button></div>
      </header>
      <p class="quote" id="quote"></p>

      <div class="weekdays" id="weekdayRow"></div>
      <div class="days" id="days"></div>

      <div class="toolbar">
        <button class="ghost" id="openBulk">Bulk Upload</button>
      </div>

      <div class="form" aria-label="Add task">
        <input type="text" id="taskTitle" placeholder="Task title" />
        <input type="date" id="taskDate" />
        <select id="taskCategory">
          <option value="Homework">Homework</option>
          <option value="Project">Project</option>
          <option value="Exam">Exam</option>
          <option value="Reminder">Reminder</option>
        </select>
        <select id="taskPriority">
          <option value="low">low</option>
          <option value="medium">medium</option>
          <option value="high">high</option>
        </select>
        <button class="primary" id="addTask">Add Task</button>
      </div>

      <ul class="list" id="taskList"></ul>
      <button class="bulk-delete" id="deleteCompleted">Delete All Completed Tasks</button>
    </section>

    <!-- Weekly View -->
    <section id="viewWeekly" role="tabpanel" aria-labelledby="tabWeekly" hidden>
      <div style="display:flex;justify-content:space-between;align-items:center;margin-bottom:10px;">
        <button id="prevWeek" class="ghost">Prev Week</button>
        <div id="weekTitle" style="font-weight:700;color:#d93a3a;">This Week</div>
        <button id="nextWeek" class="ghost">Next Week</button>
      </div>
      <div id="weeklyContainer"></div>
      <button class="bulk-delete" id="deleteCompletedWeekly">Delete All Completed Tasks</button>
    </section>

    <!-- Bulk Upload Modal -->
    <div class="modal-backdrop" id="bulkModal" role="dialog" aria-modal="true" aria-labelledby="bulkTitle">
      <div class="modal">
        <header>
          <h2 id="bulkTitle">Bulk Upload Tasks</h2>
          <button class="tab-btn" id="closeBulk" aria-label="Close">Close</button>
        </header>
        <p class="muted">Paste one task per line in the format:<br><code>Title,YYYY-MM-DD,Category,Priority</code></p>
        <textarea id="bulkInput" placeholder="Essay,2025-10-28,Project,low&#10;Math Homework,2025-10-30,Homework,high"></textarea>
        <div id="bulkErrors" class="muted" aria-live="polite" style="margin-top:6px"></div>
        <div class="actions">
          <button class="ghost" id="bulkClear">Clear</button>
          <button class="primary" id="bulkImport">Import Tasks</button>
        </div>
      </div>
    </div>
  </main>

  <script>
  (function(){
    // Password gate
    const PASSWORD = 'Moana0121';
    const lock = document.getElementById('lockScreen');
    const lockCard = document.getElementById('lockCard');
    const lockInput = document.getElementById('lockInput');
    const unlockBtn = document.getElementById('unlockBtn');
    const appRoot = document.getElementById('appRoot');

    function unlock(){
      const ok = lockInput.value === PASSWORD;
      if(ok){ lock.style.display='none'; appRoot.hidden=false; try{ localStorage.setItem('olivia_authed','1'); }catch{} initApp(); }
      else { lockCard?.classList?.remove('shake'); void lockCard?.offsetWidth; lockCard?.classList?.add('shake'); lockInput.value=''; lockInput.focus(); }
    }
    unlockBtn.addEventListener('click', unlock);
    lockInput.addEventListener('keydown', (e)=>{ if(e.key==='Enter') unlock(); });
    try{ if(localStorage.getItem('olivia_authed')==='1'){ lock.style.display='none'; appRoot.hidden=false; } }catch{}

    // App
    function initApp(){
      // Elements
      const tabCalendar = document.getElementById('tabCalendar');
      const tabWeekly = document.getElementById('tabWeekly');
      const viewCalendar = document.getElementById('viewCalendar');
      const viewWeekly = document.getElementById('viewWeekly');

      const monthYear = document.getElementById('monthYear');
      const prevMonth = document.getElementById('prevMonth');
      const nextMonth = document.getElementById('nextMonth');
      const daysEl = document.getElementById('days');
      const weekdayRow = document.getElementById('weekdayRow');
      const quote = document.getElementById('quote');

      const addTaskBtn = document.getElementById('addTask');
      const taskTitle = document.getElementById('taskTitle');
      const taskDate = document.getElementById('taskDate');
      const taskCategory = document.getElementById('taskCategory');
      const taskPriority = document.getElementById('taskPriority');
      const taskList = document.getElementById('taskList');

      const openBulk = document.getElementById('openBulk');
      const bulkModal = document.getElementById('bulkModal');
      const closeBulk = document.getElementById('closeBulk');
      const bulkInput = document.getElementById('bulkInput');
      const bulkImport = document.getElementById('bulkImport');
      const bulkErrors = document.getElementById('bulkErrors');
      const bulkClear = document.getElementById('bulkClear');

      const prevWeekBtn = document.getElementById('prevWeek');
      const nextWeekBtn = document.getElementById('nextWeek');
      const weekTitle = document.getElementById('weekTitle');
      const weeklyContainer = document.getElementById('weeklyContainer');

      // Data
      const STORAGE_KEY = 'schoolTasks_OliviaSims';
      const QUOTES = [
        "Keep going, Olivia. You're doing great.",
        "One assignment at a time.",
        "You can handle this.",
        "Small steps add up.",
        "Stay focused and take a breath."
      ];
      const CATEGORIES = new Set(['Homework','Project','Exam','Reminder']);
      const PRIORITIES = new Set(['low','medium','high']);

      const TODAY = new Date();
      let viewMonth = new Date(TODAY.getFullYear(), TODAY.getMonth(), 1);
      let tasks = [];
      try{ tasks = JSON.parse(localStorage.getItem(STORAGE_KEY)||'[]'); }catch{ tasks=[]; }

      let activeTab = localStorage.getItem('uiTab_Olivia') || 'calendar';

      // Helpers
      const fmt = (d, opts) => new Intl.DateTimeFormat(undefined, opts).format(d);
      const ymd = d => d.toISOString().slice(0,10);
      const parseDate = s => { const m = /^\d{4}-\d{2}-\d{2}$/.test(s) ? new Date(s+'T00:00:00') : null; return m && !isNaN(m) ? m : null; };
      const save = () => { try{ localStorage.setItem(STORAGE_KEY, JSON.stringify(tasks)); }catch{} };

      function setTab(tab){
        activeTab = tab;
        localStorage.setItem('uiTab_Olivia', tab);
        const calActive = tab==='calendar';
        tabCalendar.setAttribute('aria-selected', calActive);
        tabWeekly.setAttribute('aria-selected', !calActive);
        viewCalendar.hidden = !calActive; viewWeekly.hidden = calActive;
      }

      // Calendar render
      function renderCalendar(){
        // Weekday header (always rebuild to avoid “missing calendar” issue)
        const W = ['Sun','Mon','Tue','Wed','Thu','Fri','Sat'];
        weekdayRow.innerHTML = W.map(w=>`<div>${w}</div>`).join('');

        monthYear.textContent = `${fmt(viewMonth,{month:'long'})} ${viewMonth.getFullYear()}`;

        const year = viewMonth.getFullYear();
        const month = viewMonth.getMonth();
        const firstDay = new Date(year, month, 1).getDay();
        const lastDate = new Date(year, month+1, 0).getDate();

        daysEl.innerHTML = '';
        for(let i=0;i<firstDay;i++){
          const e=document.createElement('div'); e.className='day-cell'; e.style.visibility='hidden'; daysEl.appendChild(e);
        }
        for(let d=1; d<=lastDate; d++){
          const cell = document.createElement('div');
          cell.className = 'day-cell';
          cell.textContent = d;
          const dateStr = `${year}-${String(month+1).padStart(2,'0')}-${String(d).padStart(2,'0')}`;
          if(ymd(new Date())===dateStr) cell.classList.add('today');
          cell.addEventListener('click', ()=> quickAdd(dateStr));
          daysEl.appendChild(cell);
        }

        renderTasks();
        quote.textContent = QUOTES[Math.floor(Math.random()*QUOTES.length)];
      }

      function quickAdd(dateStr){
        const t = prompt('Add a task for '+dateStr+':');
        if(!t) return;
        tasks.push({ title:t.trim(), date:dateStr, category:'Homework', priority:'medium', done:false });
        save(); renderTasks(); if(activeTab==='weekly') renderWeekly();
      }

      function escapeHtml(s){ return s.replace(/[&<>"]/g, c=> ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;'}[c]) ); }

      // Calendar view task list
      function renderTasks(){
        taskList.innerHTML='';
        if(!tasks.length){ taskList.innerHTML = '<li class="item">No tasks</li>'; return; }
        const sorted = [...tasks].sort((a,b)=> a.date.localeCompare(b.date));
        for(const t of sorted){
          const li = document.createElement('li');
          li.className = 'item'+(t.done?' done':'');
          li.innerHTML = `<div><span class="badge ${t.category}">${t.category}</span><strong>${escapeHtml(t.title)}</strong> (${t.date}) <span class="dot ${t.priority}"></span></div>
                          <div><input type="checkbox" ${t.done?'checked':''}><button class="delete-btn">Delete</button></div>`;
          li.querySelector('input').addEventListener('change', ()=>{ t.done=!t.done; save(); renderTasks(); if(activeTab==='weekly') renderWeekly(); });
          const doDel = ()=>{ if(confirm('Delete this task?')){ tasks = tasks.filter(x=>x!==t); save(); renderTasks(); if(activeTab==='weekly') renderWeekly(); } };
          li.querySelector('.delete-btn').addEventListener('click', doDel);
          li.addEventListener('dblclick', doDel);
          taskList.appendChild(li);
        }
      }

      // Add task form
      addTaskBtn.addEventListener('click', ()=>{
        const title = (taskTitle.value||'').trim();
        const date = taskDate.value;
        const category = taskCategory.value;
        const priority = taskPriority.value;
        if(!title || !date) return alert('Please fill out both title and date');
        tasks.push({ title, date, category, priority, done:false });
        save(); taskTitle.value=''; taskDate.value=''; renderTasks(); if(activeTab==='weekly') renderWeekly();
      });

      // Month nav
      prevMonth.addEventListener('click', ()=>{ viewMonth.setMonth(viewMonth.getMonth()-1); renderCalendar(); });
      nextMonth.addEventListener('click', ()=>{ viewMonth.setMonth(viewMonth.getMonth()+1); renderCalendar(); });

      // Bulk delete
      document.getElementById('deleteCompleted').addEventListener('click', ()=>{
        if(confirm('Delete all completed tasks?')){ tasks = tasks.filter(t=>!t.done); save(); renderTasks(); if(activeTab==='weekly') renderWeekly(); }
      });
      document.getElementById('deleteCompletedWeekly').addEventListener('click', ()=>{
        if(confirm('Delete all completed tasks?')){ tasks = tasks.filter(t=>!t.done); save(); renderTasks(); renderWeekly(); }
      });

      // Bulk upload modal
      openBulk.addEventListener('click', ()=>{ bulkModal.style.display='flex'; bulkInput.focus(); });
      closeBulk.addEventListener('click', ()=>{ bulkModal.style.display='none'; bulkErrors.textContent=''; });
      bulkClear.addEventListener('click', ()=>{ bulkInput.value=''; bulkErrors.textContent=''; });
      bulkImport.addEventListener('click', ()=>{
        const lines = bulkInput.value.split(/\n+/).map(l=>l.trim()).filter(Boolean);
        let ok=0, bad=0;
        for(const line of lines){
          const parts = line.split(',').map(x=>x.trim());
          if(parts.length<2){ bad++; continue; }
          const [title,date,category='Homework',priority='medium'] = parts;
          const d=parseDate(date); if(!d){ bad++; continue; }
          const catOk = CATEGORIES.has(category); const priOk = PRIORITIES.has(priority);
          tasks.push({ title, date: ymd(d), category: catOk?category:'Homework', priority: priOk?priority:'medium', done:false });
          ok++;
        }
        save(); renderTasks(); if(activeTab==='weekly') renderWeekly();
        bulkErrors.textContent = `Imported ${ok} task(s). ${bad? bad+" line(s) skipped." : ''}`;
        if(ok && !bad){ bulkModal.style.display='none'; bulkInput.value=''; }
      });

      // Weekly view
      let weekAnchor = startOfWeek(new Date()); // Monday start
      function startOfWeek(d){
        const tmp = new Date(d.getFullYear(), d.getMonth(), d.getDate());
        const day = tmp.getDay(); // 0 Sun .. 6 Sat
        const diff = (day===0? -6 : 1 - day); // Monday
        tmp.setDate(tmp.getDate()+diff); tmp.setHours(0,0,0,0); return tmp;
      }

      function renderWeekly(){
        weeklyContainer.innerHTML='';
        const start = new Date(weekAnchor);
        const end = new Date(start); end.setDate(end.getDate()+6);
        weekTitle.textContent = `${fmt(start,{month:'short', day:'numeric'})} – ${fmt(end,{month:'short', day:'numeric', year:'numeric'})}`;
        for(let i=0;i<7;i++){
          const dayDate = new Date(start); dayDate.setDate(start.getDate()+i);
          const dateStr = ymd(dayDate);
          const group = document.createElement('div');
          group.style.background = '#fff1f1'; group.style.padding='10px'; group.style.borderRadius='8px'; group.style.margin='6px 0';

          const label = document.createElement('h3'); label.textContent = dayDate.toLocaleDateString(undefined,{weekday:'long', month:'short', day:'numeric'});
          label.style.color = '#d93a3a'; group.appendChild(label);

          const todays = tasks.filter(t=>t.date===dateStr).sort((a,b)=> (a.priority>b.priority? -1:1));
          if(!todays.length){
            const empty = document.createElement('div'); empty.textContent='No tasks'; empty.style.color='#a34747'; group.appendChild(empty);
          } else {
            for(const t of todays){
              const row = document.createElement('div'); row.className='item'+(t.done?' done':'');
              row.innerHTML = `<div><span class="badge ${t.category}">${t.category}</span><strong>${escapeHtml(t.title)}</strong><span class="dot ${t.priority}"></span></div>
                               <div><input type="checkbox" ${t.done?'checked':''}><button class="delete-btn">Delete</button></div>`;
              row.querySelector('input').addEventListener('change', ()=>{ t.done=!t.done; save(); renderWeekly(); renderTasks(); });
              const doDel = ()=>{ if(confirm('Delete this task?')){ tasks = tasks.filter(x=>x!==t); save(); renderWeekly(); renderTasks(); } };
              row.querySelector('.delete-btn').addEventListener('click', doDel);
              row.addEventListener('dblclick', doDel);
              group.appendChild(row);
            }
          }
          weeklyContainer.appendChild(group);
        }
      }

      // Week nav
      prevWeekBtn.addEventListener('click', ()=>{ weekAnchor.setDate(weekAnchor.getDate()-7); renderWeekly(); });
      nextWeekBtn.addEventListener('click', ()=>{ weekAnchor.setDate(weekAnchor.getDate()+7); renderWeekly(); });

      // Tabs
      tabCalendar.addEventListener('click', ()=> setTab('calendar'));
      tabWeekly.addEventListener('click', ()=> setTab('weekly'));

      // Init
      setTab(activeTab);
      renderCalendar();
      renderWeekly();

      // Keyboard shortcuts (month)
      window.addEventListener('keydown', (e)=>{
        if(appRoot.hidden) return;
        if(e.key==='ArrowLeft' && activeTab==='calendar') prevMonth.click();
        if(e.key==='ArrowRight' && activeTab==='calendar') nextMonth.click();
      });
    }

    // If already unlocked this session
    if(!appRoot.hidden){ initApp(); }
  })();
  </script>
</body>
</html>
